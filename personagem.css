:root{
  /* readability-first tokens */
  --card: rgba(255,255,255,.94);
  --card2: rgba(255,255,255,.86);
  --ink: rgba(16,18,22,.92);
  --muted: rgba(16,18,22,.64);
  --line: rgba(16,18,22,.12);
  --focus: rgba(120,172,255,.55);
  --brand: rgba(120,172,255,.95);
  --shadow: 0 18px 60px rgba(0,0,0,.20);
  --shadow2: 0 10px 26px rgba(0,0,0,.14);
  --radius: 18px;
}

/* Dark mode: toggled by body.theme-dark */
body.theme-dark.charPage{
  --card: rgba(18,20,26,.90);
  --card2: rgba(18,20,26,.72);
  --ink: rgba(255,255,255,.92);
  --muted: rgba(255,255,255,.62);
  --line: rgba(255,255,255,.12);
  --focus: rgba(150,196,255,.50);
  --brand: rgba(150,196,255,.95);
  --shadow: 0 22px 70px rgba(0,0,0,.55);
  --shadow2: 0 12px 30px rgba(0,0,0,.42);
}

/* =========================
   BACKGROUND READABILITY
========================= */

body.charPage{
  color: var(--ink);
  position: relative;
}

/* Darken + soften the background image so text/cards remain readable */
body.charPage .bg{
  filter: saturate(1.05) contrast(1.08) brightness(.55) blur(1.2px);
}
body.theme-dark.charPage .bg{
  filter: saturate(1.02) contrast(1.10) brightness(.40) blur(1.6px);
}

/* Extra overlay layer (does not affect clicks) */
body.charPage::after{
  content:"";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1;
  background:
    radial-gradient(900px 480px at 20% 10%, rgba(255,255,255,.55), rgba(255,255,255,0) 60%),
    radial-gradient(900px 480px at 80% 20%, rgba(255,255,255,.35), rgba(255,255,255,0) 62%),
    linear-gradient(180deg, rgba(255,255,255,.45), rgba(255,255,255,.18));
}
body.theme-dark.charPage::after{
  background:
    radial-gradient(900px 480px at 20% 10%, rgba(0,0,0,.55), rgba(0,0,0,0) 60%),
    radial-gradient(900px 480px at 80% 20%, rgba(0,0,0,.35), rgba(0,0,0,0) 62%),
    linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.22));
}

/* =========================
   TOPBAR / NAV
========================= */

.charTopbar{
  position: sticky;
  top: 0;
  z-index: 50;
  backdrop-filter: blur(14px);
  background: linear-gradient(180deg, rgba(0,0,0,.68), rgba(0,0,0,.24));
  border-bottom: 1px solid rgba(255,255,255,.10);
}
body.theme-dark .charTopbar{
  background: linear-gradient(180deg, rgba(0,0,0,.78), rgba(0,0,0,.30));
}

.charNav{
  display: grid;
  grid-template-columns: 1.2fr 1.6fr 1.2fr;
  gap: 14px;
  align-items: center;
  padding: 12px 0;
}

.charLeft{display:flex;align-items:center;gap:12px;min-width:0;}
.charBack{
  width: 40px;height:40px;display:grid;place-items:center;
  border: 1px solid rgba(255,255,255,.18);
  border-radius: 14px;
  color: rgba(255,255,255,.92);
  background: rgba(255,255,255,.08);
  text-decoration:none;
  box-shadow: var(--shadow2);
}
.charBack:hover{background: rgba(255,255,255,.12);}

.charNameWrap{min-width:0;}
.charName{
  font-family: "Cinzel", serif;
  letter-spacing: .08em;
  font-weight: 700;
  font-size: 18px;
  color: rgba(255,255,255,.95);
  text-transform: uppercase;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.charMeta{
  font-family: "Inter", system-ui, sans-serif;
  color: rgba(255,255,255,.78);
  font-size: 12.5px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.charTabs{display:flex;justify-content:center;gap:8px;flex-wrap:wrap;}
.tabBtn{
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.08);
  color: rgba(255,255,255,.90);
  border-radius: 999px;
  padding: 9px 12px;
  font: 700 13px/1 "Inter", system-ui, sans-serif;
  cursor: pointer;
  transition: transform .15s ease, background .15s ease, border-color .15s ease;
}
.tabBtn:hover{transform: translateY(-1px); background: rgba(255,255,255,.12);}
.tabBtn.isActive{
  background: rgba(120,172,255,.22);
  border-color: rgba(120,172,255,.44);
}

.charRight{display:flex;align-items:center;justify-content:flex-end;gap:10px;}
.charSearch{
  display:flex;align-items:center;gap:8px;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.08);
  border-radius: 999px;
  padding: 9px 12px;
  min-width: 240px;
  box-shadow: var(--shadow2);
}
.charSearchIcon{color: rgba(255,255,255,.80);}
.charSearch input{
  width: 100%;
  border: 0;
  outline: none;
  background: transparent;
  color: rgba(255,255,255,.95);
  font: 600 13px/1 "Inter", system-ui, sans-serif;
}
.charSearch input::placeholder{color: rgba(255,255,255,.62);}

.iconBtn{
  width: 40px;height:40px;
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.08);
  color: rgba(255,255,255,.95);
  cursor:pointer;
  box-shadow: var(--shadow2);
}
.iconBtn:hover{background: rgba(255,255,255,.12);}

.charAvatar{
  width: 40px;height:40px;
  border-radius: 16px;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.08);
  display:grid;place-items:center;
  color: rgba(255,255,255,.95);
  box-shadow: var(--shadow2);
}

/* =========================
   PANELS / GRID
========================= */

.charMain{padding: 22px 0 70px;}
.tabPanel{display:none;}
.tabPanel.isActive{display:block;}

.tabTitle{
  font-family: "Cinzel", serif;
  letter-spacing: .06em;
  text-transform: uppercase;
  font-weight: 700;
  color: rgba(255,255,255,.92);
  text-shadow: 0 10px 30px rgba(0,0,0,.35);
  margin: 6px 0 12px;
}

.charGrid{
  display:grid;
  grid-template-columns: 320px minmax(0, 1fr) 320px;
  gap: 18px;
  align-items: start;
}

.lowerGrid{
  margin-top: 18px;
  display:grid;
  grid-template-columns: 1.2fr .8fr;
  gap: 18px;
}

/* =========================
   CARD BASE
========================= */

.cCard{
  background: var(--card);
  border: 1px solid var(--line);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow: hidden;
}

.cardHead{
  padding: 14px 16px;
  border-bottom: 1px solid var(--line);
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 12px;
}

.cardTitle{
  margin: 0;
  font: 800 12.5px/1 "Inter", system-ui, sans-serif;
  letter-spacing: .10em;
  text-transform: uppercase;
  color: var(--muted);
}

.cardHint{
  font: 600 12px/1.25 "Inter", system-ui, sans-serif;
  color: var(--muted);
  opacity: .95;
  text-align: right;
}

.cardTools{display:flex;gap:8px;align-items:center;}

.miniBtn{
  border: 1px solid var(--line);
  background: var(--card2);
  border-radius: 14px;
  padding: 8px 10px;
  font: 700 12px/1 "Inter",system-ui,sans-serif;
  cursor: pointer;
  color: var(--ink);
  transition: transform .15s ease, filter .15s ease;
}
.miniBtn:hover{transform: translateY(-1px); filter: brightness(1.02);}

/* =========================
   PROFILE
========================= */

.profileBody{padding: 14px 16px; display:flex; gap: 14px; flex-direction: column;}

.avatarBig{
  width: 100%;
  aspect-ratio: 1 / 1;
  border-radius: 16px;
  border: 1px dashed var(--line);
  background: linear-gradient(135deg, rgba(0,0,0,.06), rgba(0,0,0,0));
  background-size: cover;
  background-position: center;
  cursor: pointer;
}
body.theme-dark .avatarBig{
  background: linear-gradient(135deg, rgba(255,255,255,.10), rgba(255,255,255,0));
}

.editableTitle{
  font-family: "Cinzel", serif;
  text-transform: uppercase;
  letter-spacing: .06em;
  font-weight: 700;
  font-size: 18px;
  margin-top: 6px;
}

.mutedLine{color: var(--muted); font: 650 13px/1.35 "Inter",system-ui,sans-serif; display:flex; gap: 8px; flex-wrap: wrap; align-items:center;}
.mutedLine .dot{opacity:.8;}

.miniGrid{display:grid; grid-template-columns: 120px 1fr; gap: 10px; margin-top: 10px;}
.miniField{display:flex; flex-direction: column; gap: 6px;}
.miniLabel{font: 800 11px/1 "Inter",system-ui,sans-serif; letter-spacing:.10em; text-transform: uppercase; color: var(--muted);}

.miniInput,
.inlineInput,
.statInput,
.modalInput,
.table input,
.moneyField input{
  width: 100%;
  border: 1px solid var(--line);
  background: rgba(255,255,255,.75);
  color: var(--ink);
  border-radius: 14px;
  padding: 10px 10px;
  font: 700 13px/1 "Inter",system-ui,sans-serif;
}
body.theme-dark .miniInput,
body.theme-dark .inlineInput,
body.theme-dark .statInput,
body.theme-dark .modalInput,
body.theme-dark .table input,
body.theme-dark .moneyField input{
  background: rgba(255,255,255,.06);
}

.miniInput:focus,
.inlineInput:focus,
.statInput:focus,
.modalInput:focus,
.table input:focus,
.moneyField input:focus,
.bigText:focus{
  outline: none;
  border-color: var(--focus);
  box-shadow: 0 0 0 4px rgba(120,172,255,.16);
}

/* clickable text fields */
.editable{
  border-radius: 12px;
  padding: 6px 8px;
  cursor: pointer;
}
.editable:hover{background: rgba(120,172,255,.12);}

/* =========================
   SUMMARY
========================= */

.summaryGrid{padding: 14px 16px; display:grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap: 10px;}
.pillInfo{border: 1px solid var(--line); background: var(--card2); border-radius: 16px; padding: 10px 10px; display:flex; flex-direction: column; gap: 6px;}
.pillKey{font: 800 10.5px/1 "Inter",system-ui,sans-serif; letter-spacing:.12em; text-transform: uppercase; color: var(--muted);}
.pillVal{font: 800 13px/1.2 "Inter",system-ui,sans-serif; color: var(--ink);}

/* =========================
   ATTRIBUTES
========================= */

.attrList{padding: 14px 16px; display:flex; flex-direction: column; gap: 10px;}
.attrRow{display:grid; grid-template-columns: 1fr 86px 66px; gap: 10px; align-items:center;}
.attrLabel{display:flex;align-items:center;gap:10px;font: 800 13px/1 "Inter",system-ui,sans-serif;color: var(--ink);}
.attrLabel .dot{width:10px;height:10px;border-radius:999px;background: rgba(120,172,255,.55);}
.attrMod{border: 1px solid var(--line); background: var(--card2); border-radius: 14px; padding: 10px; text-align:center; font: 900 13px/1 "Inter",system-ui,sans-serif;}

/* =========================
   STATUS
========================= */

.statusGrid{padding: 14px 16px; display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: 10px;}
.statBox{border: 1px solid var(--line); background: var(--card2); border-radius: 16px; padding: 10px; display:flex; flex-direction: column; gap: 8px;}
.statBox.wide{grid-column: span 2;}
.statLabel{font: 900 10.5px/1 "Inter",system-ui,sans-serif; letter-spacing:.12em; text-transform: uppercase; color: var(--muted);}
.hpRow{display:flex; align-items:center; gap: 10px;}
.hpSlash{color: var(--muted); font: 900 14px/1 "Inter",system-ui,sans-serif;}

/* =========================
   TEXT AREAS
========================= */

.bigText{
  width: 100%;
  min-height: 140px;
  resize: vertical;
  border: 0;
  border-top: 1px solid var(--line);
  padding: 12px 14px;
  background: transparent;
  color: var(--ink);
  font: 600 13px/1.55 "Inter",system-ui,sans-serif;
}
.bigText.tall{min-height: 340px;}
.bigText::placeholder{color: rgba(16,18,22,.45);}
body.theme-dark .bigText::placeholder{color: rgba(255,255,255,.40);}

/* =========================
   SKILLS
========================= */

.skillsList{padding: 10px 12px 14px; display:flex; flex-direction: column; gap: 8px;}
.skillRow{
  border: 1px solid var(--line);
  background: var(--card2);
  border-radius: 16px;
  padding: 10px;
  display:grid;
  grid-template-columns: 22px 1fr 72px 78px;
  gap: 10px;
  align-items:center;
}
.skillName{font: 800 13px/1 "Inter",system-ui,sans-serif;}
.skillMeta{font: 700 11.5px/1 "Inter",system-ui,sans-serif; color: var(--muted);}
.skillBonus{font: 900 13px/1 "Inter",system-ui,sans-serif; text-align:right;}
.skillRow input[type="checkbox"]{width:18px;height:18px; accent-color: rgba(120,172,255,.95);}

/* =========================
   TABLE-LIKE LISTS
========================= */

.table{padding: 10px 12px 14px; display:flex; flex-direction: column; gap: 10px;}
.tRow{
  border: 1px solid var(--line);
  background: var(--card2);
  border-radius: 16px;
  padding: 10px;
  display:grid;
  gap: 10px;
  align-items:center;
}

/* Attacks: name / tohit / dmg / type / actions */
.tRow.attack{grid-template-columns: 1.2fr .55fr .75fr .65fr 86px;}
/* Inventory: item / qty / notes / actions */
.tRow.item{grid-template-columns: 1.1fr .45fr 1fr 86px;}

.rowActions{display:flex; justify-content:flex-end; gap: 8px;}
.danger{
  border-color: rgba(255,80,80,.35) !important;
  background: rgba(255,80,80,.10) !important;
}

/* =========================
   MONEY
========================= */

.moneyRow{padding: 12px 14px 16px; border-top: 1px solid var(--line);}
.moneyLabel{font: 900 11px/1 "Inter",system-ui,sans-serif; letter-spacing:.12em; text-transform: uppercase; color: var(--muted); margin-bottom: 10px;}
.moneyGrid{display:grid; grid-template-columns: repeat(5, minmax(0,1fr)); gap: 10px;}
.moneyField{display:flex; align-items:center; justify-content:space-between; gap: 8px; border: 1px solid var(--line); background: var(--card2); border-radius: 16px; padding: 8px 10px; font: 900 12px/1 "Inter",system-ui,sans-serif; color: var(--muted);}
.moneyField input{padding: 10px 10px;}

/* =========================
   FEATURES LIST
========================= */

.featuresList{padding: 10px 12px 14px; display:flex; flex-direction: column; gap: 10px;}
.featureCard{border: 1px solid var(--line); background: var(--card2); border-radius: 16px; padding: 10px; display:flex; flex-direction: column; gap: 8px;}
.featureTop{display:flex; align-items:center; justify-content:space-between; gap: 10px;}
.featureName{font: 900 13px/1.2 "Inter",system-ui,sans-serif;}
.featureText{font: 650 13px/1.55 "Inter",system-ui,sans-serif; color: var(--ink);}

/* =========================
   DRAWINGS TAB
========================= */

.drawingsHint{padding: 12px 14px 0; color: var(--muted); font: 650 13px/1.5 "Inter",system-ui,sans-serif;}
.drawingsActions{padding: 12px 14px 14px; display:flex; justify-content:flex-end;}

/* =========================
   MODAL
========================= */

.cModal{position: fixed; inset:0; display:none; z-index: 80;}
.cModal[aria-hidden="false"]{display:block;}
.cModalBackdrop{position:absolute; inset:0; background: rgba(0,0,0,.45); backdrop-filter: blur(6px);}

.cModalCard{
  position: relative;
  width: min(520px, calc(100% - 24px));
  margin: 10vh auto;
  background: var(--card);
  border: 1px solid var(--line);
  border-radius: 20px;
  box-shadow: 0 30px 120px rgba(0,0,0,.55);
  overflow:hidden;
}

.cModalHead{display:flex; align-items:center; justify-content:space-between; gap: 12px; padding: 14px 16px; border-bottom: 1px solid var(--line);}
.cModalTitle{font: 900 13px/1 "Inter",system-ui,sans-serif; letter-spacing:.10em; text-transform: uppercase; color: var(--muted);}
.cModalBody{padding: 14px 16px; display:flex; flex-direction: column; gap: 12px;}

.cModalActions{display:flex; justify-content:flex-end; gap: 10px;}

/* Search highlight */
.hl{background: rgba(255,230,120,.38); border-radius: 6px; padding: 0 2px;}
body.theme-dark .hl{background: rgba(255,230,120,.22);}

/* =========================
   RESPONSIVE
========================= */

@media (max-width: 1100px){
  .charNav{grid-template-columns: 1fr; gap: 10px;}
  .charTabs{justify-content:flex-start;}
  .charRight{justify-content:flex-start; flex-wrap: wrap;}
  .charSearch{min-width: 0; width: 100%;}

  .charGrid{grid-template-columns: 1fr;}
  .lowerGrid{grid-template-columns: 1fr;}
  .summaryGrid{grid-template-columns: repeat(2, minmax(0,1fr));}
  .moneyGrid{grid-template-columns: repeat(3, minmax(0,1fr));}

  .tRow.attack{grid-template-columns: 1fr 1fr;}
  .tRow.item{grid-template-columns: 1fr 1fr;}
}
